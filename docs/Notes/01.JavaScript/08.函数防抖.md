---
title: 函数防抖
date: 2021-08-30 23:12:24
permalink: /pages/454889/
categories:
  - JavaScript
tags:
  - 防抖
---

```ts
interface Debounced {
  (...args: any[]): any
  cancel?: () => any
}

function debounce(func: () => any, wait = 0, immediate = false): Debounced {
  let timeout: NodeJS.Timeout = null
  let result = null

  const debounced: Debounced = function(...args) {
    if (timeout) clearTimeout(timeout)

    if (immediate) {
      const callNow = timeout === null // 如果已经执行过，不再执行

      timeout = setTimeout(() => (timeout = null), wait)

      if (callNow) result = func.apply(this, args)
    } else {
      timeout = setTimeout(() => func.apply(this, args), wait)
    }

    return result
  }

  debounced.cancel = () => {
    clearTimeout(timeout)
    timeout = null
  }

  return debounced
}
```

<!-- more -->
